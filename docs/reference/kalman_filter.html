<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Kalman Filter Estimation — kalman_filter • simts</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Kalman Filter Estimation — kalman_filter" />
<meta property="og:description" content="Compute the Kalman Filter estimation for the sum of any combinations of AR processes, RW, WN and DR" />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simts</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/vignettes.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/SMAC-Group/simts">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Kalman Filter Estimation</h1>
    <small class="dont-index">Source: <a href='https://github.com/SMAC-Group/simts/blob/master/R/kalman_filter_gen.R'><code>R/kalman_filter_gen.R</code></a></small>
    <div class="hidden name"><code>kalman_filter.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute the Kalman Filter estimation for the sum of any combinations of AR processes, RW, WN and DR</p>
    </div>

    <pre class="usage"><span class='fu'>kalman_filter</span><span class='op'>(</span>
  <span class='va'>model</span>,
  <span class='va'>y</span>,
  estimate_model <span class='op'>=</span> <span class='cn'>F</span>,
  model_to_estimate <span class='op'>=</span> <span class='cn'>NULL</span>,
  method <span class='op'>=</span> <span class='st'>"mle"</span>,
  h <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p>a <code>ts.model</code> object with specified parameters values</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>a <code>lts</code> object</p></td>
    </tr>
    <tr>
      <th>estimate_model</th>
      <td><p>a bolean indicating whether or not to estimate the parameters values of a provided model, default is <code>False</code></p></td>
    </tr>
    <tr>
      <th>model_to_estimate</th>
      <td><p>a <code>ts.model</code> object without parameters values specified if <code>estimate_model</code> is set to <code>True</code></p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>specify the method of estimation if <code>estimate_model</code> is set to <code>True</code> and <code>model_to_estimate</code> is provided</p></td>
    </tr>
    <tr>
      <th>h</th>
      <td><p>Number of periods for forecasting</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a <code>KF</code> object with the structure:</p><dl>
<dt>forecast</dt><dd><p><code>X_t|t-1</code></p></dd>
<dt>forecast_cov_mat</dt><dd><p>Estimated variance-covariance for <code>X_t|t-1</code></p></dd>
<dt>filter</dt><dd><p><code>X_t|t</code></p></dd>
<dt>filter_cov_mat</dt><dd><p>Estimated variance-covariance for <code>X_t|t</code></p></dd>
<dt>smooth</dt><dd><p><code>X_t|t</code> with a forward and backward Kalman filter</p></dd>
<dt>smooth_cov_mat</dt><dd><p>Estimated variance-covariance for the smoothed states</p></dd>
<dt>y</dt><dd><p>Observed time serie</p></dd>
<dt>y_d</dt><dd><p>Unobserved states composing the time serie</p></dd>
<dt>print</dt><dd><p>Model structure</p></dd>

</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Compute a kalman filter on a state space model which
can be composed of the sum of AR(), RW(), DR() and WN() processes.
Note that there can be any ammount of AR() processes while RW(), DR() and WN()
processes are limited to 1. The function can both estimate the model parameter
from a given model and apply the kalman filter or directly apply the kalman 
filter with specified parameters. The function takes as input the
model which is the defined model and y which is the observed time serie.
If estimate_model is set to False (by default), the user need to provide a model
and its parameters (a ts.model class object). If estimate_model is set to True, the user just need to provide
the selected model to estimate and the estimation method (see function estimate).</p>
<p>Note on the calculation of the smoothed states:</p>
<p>The variance-covariance matrix <code>P_s</code> for the smoothed states is calculated as follows:</p>
<p><code>P_s = (P_f^-1 + P_b^-1)^-1</code></p>
<p>where <code>P_f</code> and <code>P_b</code> are the variance-covariance matrices of the filtered states for respectively the foward and backward kalman filter algorithm.</p>
<p>The smoothed states <code>X_s</code> are calculated as follows:</p>
<p><code>X_b + P_s*P_f^-1(X_f - X_b)</code></p>
<p>where <code>P_f</code> and <code>P_b</code> are the variance-covariance matrices of the filtered states for respectively the foward and backward kalman filter algorithm, and <code>X_f</code> and <code>X_b</code> are the filtered states for respectively the foward and backward kalman filter algorithm.
#Filter a 2*AR1 + DR + RW + WN process
set.seed(123)
model = AR(.3, 2) + AR(.5,3) + DR(.1) + RW(3) + WN(4) 
n = 250
y = gen_lts(n = n, model = model)
my_res = kalman_filter(model = model, y = y)</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Lionel Voirol</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Stéphane Guerrier, James Balamuta, Roberto Molinari, Justin Lee, Lionel Voirol, Yuming Zhang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


